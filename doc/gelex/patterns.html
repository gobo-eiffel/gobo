<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<title>Gelex: Patterns</title>
</head>

<body bgcolor="#FFFFFF">

<h1>Patterns</h1>

<p>The patterns in the input are written using an extended set of
regular expressions. These are:</p>

<blockquote>
    <dl>
        <dt><font color="#FF0000"><tt>x</tt></font></dt>
        <dd>match the character '<tt>x</tt>'</dd>
        <dt><font color="#FF0000"><tt>.</tt></font></dt>
        <dd>any character except newline</dd>
        <dt><font color="#FF0000"><tt>[xyz]</tt></font></dt>
        <dd>a <em>character class</em>; in this case, the pattern
            matches either an '<tt>x</tt>', a '<tt>y</tt>' or a '<tt>z</tt>'</dd>
        <dt><font color="#FF0000"><tt>[abj-oZ]</tt></font></dt>
        <dd>a <em>character class</em> with a range in it;
            matches an '<tt>a</tt>', a '<tt>b</tt>', any letter
            from '<tt>j</tt>' through '<tt>o</tt>', or a '<tt>Z</tt>'</dd>
        <dt><font color="#FF0000"><tt>[^A-Z]</tt></font></dt>
        <dd>a <em>negated character class</em>, i.e., any
            character but those in the class. In this case, any
            character except an uppercase letter.</dd>
        <dt><font color="#FF0000"><tt>[^A-Z\n]</tt></font></dt>
        <dd>any character except an uppercase letter or a newline</dd>
        <dt><font color="#FF0000"><tt>r*</tt></font></dt>
        <dd>zero or more <tt>r</tt>'s, where <tt>r</tt> is any
            regular expression</dd>
        <dt><font color="#FF0000"><tt>r+</tt></font></dt>
        <dd>one or more <tt>r</tt>'s</dd>
        <dt><font color="#FF0000"><tt>r?</tt></font></dt>
        <dd>zero or one <tt>r</tt>'s (that is, &quot;an optional <tt>r</tt>&quot;)</dd>
        <dt><font color="#FF0000"><tt>r{2,5}</tt></font></dt>
        <dd>anywhere from two to five <tt>r</tt>'s</dd>
        <dt><font color="#FF0000"><tt>r{2,}</tt></font></dt>
        <dd>two or more <tt>r</tt>'s</dd>
        <dt><font color="#FF0000"><tt>r{4}</tt></font></dt>
        <dd>exactly four <tt>r</tt>'s</dd>
        <dt><font color="#FF0000"><tt>{name}</tt></font></dt>
        <dd>the expansion of the &quot;<tt>name</tt>&quot; <a
            href="description.html#definitions">definition</a></dd>
        <dt><font color="#FF0000"><tt>&quot;[xyz]\&quot;foo&quot;</tt></font></dt>
        <dd>the literal string: <tt>[xyz]&quot;foo</tt></dd>
        <dt><font color="#FF0000"><tt>\X</tt></font></dt>
        <dd>if <tt>X</tt> is an '<tt>a</tt>', '<tt>b</tt>', '<tt>f</tt>',
            '<tt>n</tt>', '<tt>r</tt>', '<tt>t</tt>', or '<tt>v</tt>',
            then the ANSI-C interpretation of <tt>\x</tt>.
            Otherwise, a literal '<tt>X</tt>' (used to escape
            operators such as '<tt>*</tt>')</dd>
        <dt><font color="#FF0000"><tt>\0</tt></font></dt>
        <dd>a null character (ASCII code <tt>0</tt>)</dd>
        <dt><font color="#FF0000"><tt>\123</tt></font></dt>
        <dd>the character with octal value <tt>123</tt></dd>
        <dt><font color="#FF0000"><tt>\x2a</tt></font></dt>
        <dd>the character with hexadecimal value <tt>2a</tt></dd>
        <dt><font color="#FF0000"><tt>(r)</tt></font></dt>
        <dd>match an <tt>r</tt>; parentheses are used to override
            <a href="#precedence">precedence</a></dd>
        <dt><font color="#FF0000"><tt>rs</tt></font></dt>
        <dd>the regular expression <tt>r</tt> followed by the
            regular expression <tt>s</tt>; called <em>concatenation</em></dd>
    </dl>
    <hr size="1" width="75%">
    <dl>
        <dt><font color="#FF0000"><tt>r|s</tt></font></dt>
        <dd>either an <tt>r</tt> or an <tt>s</tt></dd>
    </dl>
    <hr size="1" width="75%">
    <dl>
        <dt><font color="#FF0000"><tt>r/s</tt></font></dt>
        <dd>an <tt>r</tt> but only if it is followed by an <tt>s</tt>.
            The text matched by <tt>s</tt> is included when
            determining whether this rule is the &quot;longest
            match&quot;, but is then returned to the input before
            the action is executed. So the action only sees the
            text matched by <tt>r</tt>. This type of pattern is
            called <em>trailing context</em>. (There are some
            combinations of <tt>r/s</tt> that <em>gelex</em>
            cannot match correctly; see notes in the Deficiencies
            / Bugs section below regarding &quot;dangerous
            trailing context&quot;.)</dd>
        <dt><font color="#FF0000"><tt>^r</tt></font></dt>
        <dd>an <tt>r</tt>, but only at the beginning of a line
            (i.e., which just starting to scan, or right after a
            newline has been scanned).</dd>
        <dt><font color="#FF0000"><tt>r$</tt></font></dt>
        <dd>an <tt>r</tt>, but only at the end of a line (i.e.,
            just before a newline). Equivalent to &quot;<tt>r/\n</tt>&quot;.</dd>
        <dd>Note that <em>gelex</em>'s notion of
            &quot;newline&quot; is exactly whatever the Eiffel
            compiler used to compile <em>gelex</em> interprets '<tt>%N</tt>'
            as; in particular, on some DOS systems you must
            either filter out <tt>\r</tt>'s in the input
            yourself, or explicitly use &quot;<tt>r/\r\n</tt>&quot;
            for &quot;<tt>r$</tt>&quot;.</dd>
    </dl>
    <hr size="1" width="75%">
    <dl>
        <dt><font color="#800000"><tt>&lt;s&gt;</tt></font><font
            color="#FF0000"><tt>r</tt></font></dt>
        <dd>an <tt>r</tt>, but only in start condition <tt>s</tt>
            (see below for discussion of start conditions)</dd>
        <dt><font color="#800000"><tt>&lt;s1,s2,s3&gt;</tt></font><font
            color="#FF0000"><tt>r</tt></font></dt>
        <dd>same, but in any of start conditions <tt>s1</tt>, <tt>s2</tt>,
            or <tt>s3</tt></dd>
        <dt><font color="#800000"><tt>&lt;*&gt;</tt></font><font
            color="#FF0000"><tt>r</tt></font></dt>
        <dd>an <tt>r</tt> in any start condition, even an
            exclusive one.</dd>
    </dl>
    <hr size="1" width="75%">
    <dl>
        <dt><font color="#FF0000"><tt>&lt;&lt;EOF&gt;&gt;</tt></font></dt>
        <dd>an end-of-file</dd>
        <dt><font color="#800000"><tt>&lt;s1,s2&gt;</tt></font><font
            color="#FF0000"><tt>&lt;&lt;EOF&gt;&gt;</tt></font></dt>
        <dd>an end-of-file when in start condition <tt>s1</tt> or
            <tt>s2</tt></dd>
    </dl>
</blockquote>

<p>Note that inside of a character class, all regular expression
operators lose their special meaning except escape ('<tt>\</tt>')
and the character class operators, '<tt>-</tt>', '<tt>]</tt>',
and, at the beginning of the class, '<tt>^</tt>'.</p>

<p>The regular expressions listed above are grouped according to <a
name="precedence">precedence</a>, from highest precedence at the
top to lowest at the bottom. Those grouped together have equal
precedence. For example,</p>

<blockquote>
    <p><font color="#FF0000"><tt>foo|bar*</tt></font></p>
</blockquote>

<p>is the same as</p>

<blockquote>
    <p><font color="#FF0000"><tt>(foo)|(ba(r*))</tt></font></p>
</blockquote>

<p>since the '<tt>*</tt>' operator has higher precedence than
concatenation, and concatenation higher than alternation ('<tt>|</tt>').
This pattern therefore matches either the string &quot;<tt>foo</tt>&quot;
or the string &quot;<tt>ba</tt>&quot; followed by zero-or-more <tt>r</tt>'s.
To match &quot;<tt>foo</tt>&quot; or zero-or-more &quot;<tt>bar</tt>&quot;'s,
use:</p>

<blockquote>
    <p><font color="#FF0000"><tt>foo|(bar)*</tt></font></p>
</blockquote>

<p>and to match zero-or-more &quot;<tt>foo</tt>&quot;'s-or-&quot;<tt>bar</tt>&quot;'s:</p>

<blockquote>
    <p><font color="#FF0000"><tt>(foo|bar)*</tt></font></p>
</blockquote>

<h3>Some notes on patterns:</h3>

<p>A negated character class such as the example <font
color="#FF0000"><tt>[^A-Z]</tt></font> above will match a newline
unless &quot;<tt>\n</tt>&quot; (or an equivalent escape sequence)
is one of the characters explicitly present in the negated
character class (e.g., <font color="#FF0000"><tt>[^A-Z\n]</tt></font>).
This is unlike how many other regular expression tools treat
negated character classes, but unfortunately the inconsistency is
historically entrenched. Matching newlines means that a pattern
like <font color="#FF0000"><tt>[^&quot;]*</tt></font> can match
the entire input unless there's<br>
another quote in the input.</p>

<p>A rule can have at most one instance of trailing context (the
'<tt>/</tt>' operator or the '<tt>$</tt>' operator). The start
condition, '<tt>^</tt>', and &quot;<tt>&lt;&lt;EOF&gt;&gt;</tt>&quot;
patterns can only occur at the beginning of a pattern, and, as
well as with '<tt>/</tt>' and '<tt>$</tt>', cannot be grouped
inside parentheses. A '<tt>^</tt>' which does not occur at the
beginning of a rule or a '<tt>$</tt>' which does not occur at the
end of a rule loses its special properties and is treated as a
normal character.</p>

<p>The following are illegal:</p>

<blockquote>
    <p><font color="#FF0000"><tt>foo/bar$</tt></font><tt><br>
    </tt><font color="#800000"><tt>&lt;sc1&gt;</tt></font><font
    color="#FF0000"><tt>foo</tt></font><font color="#800000"><tt>&lt;sc2&gt;</tt></font><font
    color="#FF0000"><tt>bar</tt></font></p>
</blockquote>

<p>Note that the first of these, can be written <font
color="#FF0000"><tt>foo/bar\n</tt></font>.</p>

<p>The following will result in '<tt>$</tt>' or '<tt>^</tt>'
being treated as a normal character:</p>

<blockquote>
    <p><font color="#FF0000"><tt>foo|(bar$)<br>
    foo|^bar</tt></font></p>
</blockquote>

<p>If what's wanted is a &quot;<tt>foo</tt>&quot; or a <tt>bar</tt>-followed-by-a-newline,
the following could be used (the special '<font color="#0000FF"><tt>|</tt></font>'
action is explained below):</p>

<blockquote>
    <pre><font color="#FF0000">foo</font>	<font color="#0000FF">|</font>
<font color="#FF0000">bar$</font>	<font color="#008080">-- action goes here</font></pre>
</blockquote>

<p>A similar trick will work for matching a <tt>foo</tt> or a <tt>bar</tt>-at-the-beginning-of-a-line.</p>

<hr size="1">

<p align="center"><font size="2"><b>- Copyright © 1997</b></font><font
size="1"><b>, </b></font><font size="2"><strong>Eric Bezault</strong></font><strong>
</strong><font size="2"><strong>-</strong> <br>
Send comments to </font><a href="mailto:ericb@gobo.demon.co.uk"><font
size="2">ericb@gobo.demon.co.uk</font></a><font size="2"> <br>
<i>$Date$ </i></font></p>
</body>
</html>
